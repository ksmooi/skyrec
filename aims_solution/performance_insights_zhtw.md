[ [English](performance_insights_enus.md) ] [ 繁體中文 ]

# 性能見解：影片分析、索引與錄製

## 介紹
在現代安全監控系統中，影像分析與錄影是至關重要的兩大功能。這兩個功能需要同時進行，並且即時處理來自多支攝影機的串流。因此，設計一個高效的應用軟體來達成這一任務變得尤為重要。本文將詳細探討在不同 GPU 配置下，如何優化和提升 AI 驅動的影片和圖像分析系統的性能。

特別是，高效推理伺服器和高效串流伺服器在此過程中扮演著關鍵角色：

1. **高效推理伺服器**：
   - 能夠平行解碼多個串流（H264/HEVC）
   - 平行預處理多個串流（包括調整大小、顏色空間轉換和對齊）
   - 善用 NVIDIA GPU 的加速技術（如 TensorRT、CUDNN 和 CUDA）
   - 優化視頻解碼、視頻預處理、AI 推理和後處理，以追求性能最大化
   - 支援標準的模型格式 ONNX

2. **高效串流伺服器**：
   - 平行處理來自多支攝影機的串流
   - 採用高效率的 Async I/O 系統設計，追求性能最大化
   - 採用 clip-based 和 object-based 索引，大幅提升資料搜尋性能
   - 支援主流和標準的存儲接口 SATA

本文提供了各種 GPU 配置下 AI 影片和圖像分析系統的詳細性能基準測試，評估了錄製功能、數據保留能力以及人臉識別和人物與車輛識別的特定分析功能。通過分析不同的 GPU 配置，本文強調了每種配置的優勢和局限性，提供了如何優化這些系統以適應不同部署場景（包括邊緣設備、工作站和數據中心）的關鍵見解。這些信息對於希望提高 AI 驅動的影片分析系統效率和效能的專業人士至關重要。


## 雙 GPU 性能基準測試

[![Performance Benchmark on Dual GPU](https://img.youtube.com/vi/sjCYWvHJ65c/0.jpg)](https://www.youtube.com/watch?v=sjCYWvHJ65c)

下表提供了雙 GPU 配置下人臉分析和人物及車輛分析的詳細性能基準測試。每個表格突出顯示了不同 NVIDIA GPU 配置的部署環境、AI 通道、分析幀速率（FPS）、NVDEC 單元、內存容量、CUDA 核心和 Tensor 核心。數據展示了雙 GPU 配置在不同部署場景（如邊緣設備、工作站和數據中心）中所達到的顯著性能提升。這些基準測試對於理解 AI 驅動的視頻分析系統在處理和分析高分辨率視頻流方面的能力至關重要。

### 各種 AI 分析的子功能

| 功能                  | 人臉分析 | 人物分析 | 車輛分析 |
|-----------------------|---------|---------|---------|
| HEVC/H264 解碼器      | V       | V       | V       |
| 人臉檢測              | V       |         |         |
| 口罩分類              | V       |         |         |
| 性別分類              | V       | V       |         |
| 年齡分類              | V       |         |         |
| 種族分類              | V       |         |         |
| 人臉識別              | V       |         |         |
| 人物檢測              |         | V       | V       |
| 上衣風格分類          |         | V       |         |
| 下裝風格分類          |         | V       |         |
| 上衣顏色分類          |         | V       |         |
| 下裝顏色分類          |         | V       |         |
| 人物識別（ReID）      |         | V       |         |
| 車輛類別分類          |         |         | V       |
| 車輛顏色分類          |         |         | V       |
| 車輛識別              |         |         | V       |

### 性能基準測試

| 雙 GPU               | 部署環境      | AI 通道  | 分析 FPS   | NVDEC | 內存        | CUDA 核心       | Tensor 核心    |
|----------------------|--------------|----------|-------------|-------|------------|------------------|-----------------|
| 2 x NVIDIA RTX 3060  | 邊緣設備      | 36       | 540         | 2 x 1 | 2 x 12 GB  | 2 x 3,584        | 2 x 112         |
| 2 x NVIDIA A5000     | 工作站        | 72       | 1,080       | 2 x 2 | 2 x 24 GB  | 2 x 8,192        | 2 x 256         |
| 2 x NVIDIA A30       | 數據中心      | 80       | 1,200       | 2 x 4 | 2 x 24 GB  | 2 x 3,584        | 2 x 224         |
| 2 x NVIDIA A100      | 數據中心      | 128      | 1,920       | 2 x 5 | 2 x 40 GB  | 2 x 6,912        | 2 x 432         |

**備註**
- HEVC 影片流（1920 x 1080，15 FPS，2 Mbps）
- H.264 影片流（1920 x 1080，15 FPS，2 Mbps）


## 單 GPU 性能基準測試

[![Performance Benchmark on Single GPU](https://img.youtube.com/vi/J13jzoFAXto/0.jpg)](https://www.youtube.com/watch?v=J13jzoFAXto)

下表提供了單 GPU 配置下人臉分析和人物及車輛分析的綜合性能基準測試。這些表格展示了不同 NVIDIA GPU 在不同部署場景（如邊緣設備、工作站和數據中心）中的關鍵指標，包括部署環境、AI 通道、分析幀速率（FPS）、NVDEC 單元、內存容量、CUDA 核心和 Tensor 核心。這些基準測試突出了不同 GPU 型號的性能能力，展示了每種配置如何處理高分辨率視頻流和複雜的 AI 處理任務，為優化 AI 驅動的視頻分析系統提供了關鍵見解。

### 性能基準測試

| 單 GPU              | 部署環境      | AI 通道  | 分析 FPS   | NVDEC | 內存    | CUDA 核心 | Tensor 核心 |
|--------------------|--------------|----------|-------------|-------|--------|------------|--------------|
| 1 x NVIDIA RTX 3060| 邊緣設備      | 18       | 270         | 1     | 12 GB  | 3,584      | 112          |
| 1 x NVIDIA A5000   | 工作站        | 36       | 540         | 2     | 24 GB  | 8,192      | 256          |
| 1 x NVIDIA A30     | 數據中心      | 40       | 600         | 4     | 24 GB  | 3,584      | 224          |
| 1 x NVIDIA A100    | 數據中心      | 60       | 900         | 5     | 40 GB  | 6,912      | 432          |

**備註**
- HEVC 影片流（1920 x 1080，15 FPS，2 Mbps）
- H.264 影片流（1920 x 1080，15 FPS，2 Mbps）


## 40 支攝像機錄製

[![40 cameras recording](https://img.youtube.com/vi/X3ISQpXO0XU/0.jpg)](https://www.youtube.com/watch?v=X3ISQpXO0XU)

### 錄製功能和數據速率

下表概述了每台服務器使用40台攝像機的錄製功能、數據速率和存儲安排。第一個表詳細說明了錄製功能，顯示所有40台攝像機可以以每台攝像機2 Mbps的速率錄製視頻，每分鐘每台攝像機生成8張縮略圖。然而，由於 GPU 的限制，只有16台攝像機可以使用 AI 通道進行每台攝像機15 FPS 的分析。

| 錄製功能           | 40台攝像機 / 服務器           | 數據速率               |
|--------------------|-----------------------------|------------------------|
| 視頻               | 全部                         | 2 Mbps / 攝像機        |
| 縮略圖             | 全部                         | 每分鐘8張圖 / 攝像機    |
| AI 通道            | 16台（受限於GPU）            | 每台15 FPS / 攝像機     |
| 片段索引 (Clip)    | 是 (最多 100 片段/分鐘)       | --                     |
| 物件索引 (Object)  | 是 (最多 300 物件/分鐘)       | --                     |

### 存儲安排

該表提供了存儲安排選項，指出了不同 HDD 容量如何影響每個磁盤上的攝像機數量和數據保留時間。例如，一個 6TB 的 HDD 可以處理 4 台攝像機，數據保留期為 30 天，而一個 10TB 的 HDD 可以容納 3 台攝像機，但保留期更長，達到 90 天。這些信息對於計劃和優化存儲解決方案以滿足特定錄製和保留需求至關重要。

| HDD 容量           | 每磁盤攝像機數量  | 數據保留時間 |
|---------------------|------------------|----------------|
| 6TB                 | 4                | 30天           |
| 8TB                 | 3                | 60天           |
| 12TB                | 4                | 60天           |
| 10TB                | 3                | 90天           |

**備註**
- 使用 SATA 端口上的 8 個 HDD 進行 40 台攝像機錄製


## 24 支攝像機錄製

[![24 cameras recording](https://img.youtube.com/vi/94v7AY0tyrA/0.jpg)](https://www.youtube.com/watch?v=94v7AY0tyrA)

### 錄製功能和數據速率

下表描述了每台服務器使用24台攝像機的錄製功能、數據速率和存儲安排。第一個表詳細說明了錄製功能，顯示所有24台攝像機可以以每台攝像機2 Mbps的速率錄製視頻，每分鐘每台攝像機生成8張縮略圖。由於 GPU 的限制，AI 通道僅可用於16台攝像機，每台攝像機處理速度為15 FPS。

| 錄製功能           | 24台攝像機 / 服務器           | 數據速率                |
|--------------------|-----------------------------|------------------------|
| 視頻               | 全部                         | 2 Mbps / 攝像機        |
| 縮略圖             | 全部                         | 每分鐘8張圖 / 攝像機    |
| AI 通道            | 16台（受限於GPU）             | 每台15 FPS / 攝像機    |
| 片段索引 (Clip)    | 是 (最多 100 片段/分鐘)       | --                     |
| 物件索引 (Object)  | 是 (最多 300 物件/分鐘)       | --                     |


### 存儲安排

該表提供了各種存儲安排選項，詳細說明了不同 HDD 配置如何影響每個磁盤上的攝像機數量和數據保留時間。例如，使用 4TB x 5 + 2TB x 1 HDD 的配置可以支持每磁盤 3 台攝像機，數據保留期為 30 天，而使用 12TB x 5 + 6TB x 1 HDD 的配置也支持每磁盤 3 台攝像機，但數據保留期延長至 90 天。這些信息有助於根據特定的錄製和保留要求進行存儲解決方案的規劃和優化。

| HDD 容量              | 每磁盤攝像機數量  | 數據保留時間 |
|---------------------|------------------|----------------|
| 4TB x 5 + 2TB x 1   | 3（推薦）        | 30天           |
| 6TB x 4             | 4                | 30天           |
| 8TB x 5 + 4TB x 1   | 3（推薦）        | 60天           |
| 12TB x 4            | 4                | 60天           |
| 12TB x 5 + 6TB x 1  | 3                | 90天           |

**備註**
- 使用 SATA 端口上的 6 個 HDD 進行 24 台攝像機錄製

